## 一、需求分析整理：
#### 收益：
* 1.ELM兑换magic
* 2.将遗物卖出（需要有人购买）
* 3.将角色卖出
* 4.World Boss

#### 成本：
* 1.magic兑换ELM
* 2.买入遗物
* 3.买入角色

#### 增量账户如何判断：
需要监听所有合约的增量event，若存在event log中EOA地址不在存量db中，该地址为新增用户，需要插入该用户地址的记录到db中。

#### 增量数据获取逻辑：
获取db中最大的区块高度，若没有则认为是0，检索链上event时只需要从该区块高度开始（为0时传入fromBlock参数为字符串earliest）


## 二、流程
#### 1. 初始化
* 初始化provider：通过url初始化arb链的provider对象
* 初始化检索条件
	+ from_height：从db中获取最近的区块高度
	* 交易合约地址：
		ELM swap：0xf904469497e6a179a9d47a7b468e4be42ec56e65
		nft swap: 0x09986b4e255b3c548041a30a2ee312fe176731c2
		magic transfer: 0x84c8bd99df40626f6d9cb9a1e71d2f65278d75fa (World Boss收益)
	* NFT token：
		0x7480224ec2b98f28cee3740c80940a2f489bf352 英雄/角色
		0x381227255ef6c5d85966b78d13e4b4a4c8719b5e 遗物
#### 2. 开启三个线程，并发获取链上数据
* 线程1：获取ELM swap的event log，获取该event log对应的block（获取时间戳），获取该event log对应的transaction（获取input data）
* 线程2：获取nft swap的event log，获取时间戳与input data同上
* 线程3：获取magic transfer的transaction，获取时间戳与input data同上
	以上都需要解析对应transaction的input data，以此来获取是否支出还是收入，以及对应金额。
#### 3. 在线程中，对链上数据进行清洗，然后存入leancloud db中
* 格式化数据后，将数据存入db中


## 三、其他：
leancloud sdk 文档学习并使用

## 四、工作量及预算预估:
* 一人月
* 费用：4225 USDT